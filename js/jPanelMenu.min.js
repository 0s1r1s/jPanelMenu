(function(e){e.jPanelMenu=function(t){if(typeof t=="undefined"||t==null)t={};var n={options:e.extend({trigger:".menu-trigger",menu:"#menu",keyboardShortcuts:!0,transitionsSupported:"WebkitTransition"in document.body.style||"MozTransition"in document.body.style||"msTransition"in document.body.style||"OTransition"in document.body.style||"Transition"in document.body.style,shiftFixedChildren:!1,openPosition:75,duration:150,openDuration:t.duration||150,closeDuration:t.duration||150,easing:"ease-in-out",openEasing:t.easing||"ease-in-out",closeEasing:t.easing||"ease-in-out",before:function(){console.log("jP.options.before();")},beforeOpen:function(){console.log("jP.options.beforeOpen();")},beforeClose:function(){console.log("jP.options.beforeClose();")},after:function(){console.log("jP.options.after();")},afterOpen:function(){console.log("jP.options.afterOpen();")},afterClose:function(){console.log("jP.options.afterClose();")}},t),menu:"#jPanelMenu-menu",panel:".jPanelMenu-panel",fixedChildren:[],timeouts:{},checkFixedChildren:function(){n.disableTransitions();var t={position:e(n.panel).css("position"),left:e(n.panel).css("left")=="auto"?0:e(n.panel).css("left")};e(n.panel).find("> *").each(function(){e(this).css("position")=="fixed"&&e(this).css("left")=="auto"&&n.fixedChildren.push(this)});if(n.fixedChildren.length>0){n.setPanelStyle({position:"relative",left:"1px"});parseInt(e(n.fixedChildren[0]).offset().left)==0&&(n.options.shiftFixedChildren=!0)}n.setPanelStyle(t)},setMenuState:function(t){var n=t?"open":"closed";e("body").attr("data-menu-position",n)},getMenuState:function(){return e("body").attr("data-menu-position")},menuIsOpen:function(){return n.getMenuState()=="open"?!0:!1},setMenuStyle:function(t){e(n.menu).css(t)},setPanelStyle:function(t){e(n.panel).css(t)},enableTransitions:function(t,r){var i=t/1e3,s=n.getCSSEasingFunction(r);n.disableTransitions();e("body").append('<style id="jPanelMenu-style-transitions">.jPanelMenu-panel{-webkit-transition: all '+i+"s "+s+"; -moz-transition: all "+i+"s "+s+"; -o-transition: all "+i+"s "+s+"; transition: all "+i+"s "+s+";}</style>")},disableTransitions:function(){e("#jPanelMenu-style-transitions").remove()},enableFixedTransitions:function(t,r,i,s){var o=i/1e3,u=n.getCSSEasingFunction(s);n.disableFixedTransitions(r);e("body").append('<style id="jPanelMenu-style-fixed-'+r+'">'+t+"{-webkit-transition: all "+o+"s "+u+"; -moz-transition: all "+o+"s "+u+"; -o-transition: all "+o+"s "+u+"; transition: all "+o+"s "+u+";}</style>")},disableFixedTransitions:function(t){e("#jPanelMenu-style-fixed-"+t).remove()},getCSSEasingFunction:function(e){switch(e){case"linear":return e;case"ease":return e;case"ease-in":return e;case"ease-out":return e;case"ease-in-out":return e;default:return"ease-in-out"}},getJSEasingFunction:function(e){switch(e){case"linear":return e;default:return"swing"}},openMenu:function(t){clearTimeout(n.timeouts.afterOpen);n.options.before();n.options.beforeOpen();n.setMenuState(!0);var r={none:t?!1:!0,transitions:t&&n.options.transitionsSupported?!0:!1};if(r.transitions||r.none){r.none&&n.disableTransitions();r.transitions&&n.enableTransitions(n.options.openDuration,n.options.openEasing);n.setPanelStyle({position:"relative",left:n.options.openPosition+"%"});n.options.shiftFixedChildren&&e(n.fixedChildren).each(function(){var t=e(this).prop("tagName").toLowerCase()+" "+e(this).attr("class"),i=t.replace(" ","."),t=t.replace(" ","-");r.none&&n.disableFixedTransitions(t);r.transitions&&n.enableFixedTransitions(i,t,n.options.openDuration,n.options.openEasing);e(this).css({left:n.options.openPosition+"%"})});n.timeouts.afterOpen=setTimeout(function(){n.disableTransitions();n.options.shiftFixedChildren&&e(n.fixedChildren).each(function(){var t=e(this).prop("tagName").toLowerCase()+" "+e(this).attr("class"),t=t.replace(" ","-");n.disableFixedTransitions(t)});n.options.after();n.options.afterOpen()},n.options.openDuration)}else{var i=n.getJSEasingFunction(n.options.openEasing);n.setPanelStyle({position:"relative"});e(n.panel).stop().animate({left:n.options.openPosition+"%"},n.options.openDuration,i,function(){n.options.after();n.options.afterOpen()});n.options.shiftFixedChildren&&e(n.fixedChildren).each(function(){e(this).stop().animate({left:n.options.openPosition+"%"},n.options.openDuration,i)})}},closeMenu:function(t){clearTimeout(n.timeouts.afterClose);n.options.before();n.options.beforeClose();n.setMenuState(!1);var r={none:t?!1:!0,transitions:t&&n.options.transitionsSupported?!0:!1};if(r.transitions||r.none){r.none&&n.disableTransitions();r.transitions&&n.enableTransitions(n.options.closeDuration,n.options.closeEasing);n.setPanelStyle({left:0});n.options.shiftFixedChildren&&e(n.fixedChildren).each(function(){var t=e(this).prop("tagName").toLowerCase()+" "+e(this).attr("class"),i=t.replace(" ","."),t=t.replace(" ","-");r.none&&n.disableFixedTransitions(t);r.transitions&&n.enableFixedTransitions(i,t,n.options.closeDuration,n.options.closeEasing);e(this).css({left:"0%"})});n.timeouts.afterClose=setTimeout(function(){n.setPanelStyle({position:"static"});n.disableTransitions();n.options.shiftFixedChildren&&e(n.fixedChildren).each(function(){var t=e(this).prop("tagName").toLowerCase()+" "+e(this).attr("class"),t=t.replace(" ","-");n.disableFixedTransitions(t)});n.options.after();n.options.afterClose()},n.options.closeDuration)}else{var i=n.getJSEasingFunction(n.options.closeEasing);e(n.panel).stop().animate({left:"0%"},n.options.closeDuration,i,function(){n.setPanelStyle({position:"static"});n.options.after();n.options.afterClose()});n.options.shiftFixedChildren&&e(n.fixedChildren).each(function(){e(this).stop().animate({left:"0%"},n.options.closeDuration,i)})}},triggerMenu:function(e){console.log(" ");console.log("--------------------------------------------------");console.log(" ");n.menuIsOpen()?n.closeMenu(e):n.openMenu(e)},initiateClickListeners:function(){e(document).on("click",n.options.trigger,function(){n.triggerMenu(!0);return!1})},destroyClickListeners:function(){e(document).off("click",n.options.trigger,null)},initiateKeyboardListeners:function(){e(document).on("keydown",function(e){switch(e.which){case 27:n.menuIsOpen()&&n.closeMenu(!0);break;case 37:n.menuIsOpen()&&n.closeMenu(!0);break;case 39:n.triggerMenu(!0);break;case 77:n.triggerMenu(!0)}return!1})},destroyKeyboardListeners:function(){e(document).off("keydown",null)},setupMarkup:function(){e("html").addClass("jPanelMenu");e("body > *").not(n.menu+", style, script").wrapAll('<div class="'+n.panel.replace(".","")+'"/>');e(n.options.menu).hide().clone().attr("id",n.menu.replace("#","")).insertAfter("body > "+n.panel)},resetMarkup:function(){e("html").removeClass("jPanelMenu");e("body > "+n.panel+" > *").unwrap();e(n.menu).remove()},init:function(){console.log(n.options);n.options.openPosition>100&&(n.options.openPosition=100);n.closeMenu();n.initiateClickListeners();n.options.keyboardShortcuts&&n.initiateKeyboardListeners();n.setMenuState(!1);n.setupMarkup();n.setMenuStyle({width:n.options.openPosition+"%"});n.checkFixedChildren()},destroy:function(){n.closeMenu();n.destroyClickListeners();n.options.keyboardShortcuts&&n.destroyKeyboardListeners();n.resetMarkup();n.fixedChildren=[]}};return{on:n.init,off:n.destroy,trigger:n.triggerMenu,open:n.openMenu,close:n.closeMenu}}})(jQuery);